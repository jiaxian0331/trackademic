<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Saved Collections - Trackademic</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='dashstyle.css') }}">
</head>
<body>
<div class="container">
    <header class="header">
        <div class="logo"><img src="{{ url_for('static', filename='trackademiclogo.png') }}" alt="Logo"></div>
        <div class="dashboard-title">Saved Posts</div>
        <div class="logout"><a href="{{ url_for('logout') }}">Logout</a></div>
    </header>

    <div class="main-layout">
        <aside class="sidebar">
            <nav class="nav-menu">
                <div class="nav-item user-profile">
                    <a href="{{ url_for('dashboard') }}">{{ username }}</a>
                </div>
                <div class="nav-item active-nav">
                    <a href="{{ url_for('saved_posts') }}">Saved Posts</a>
                </div>
                <div class="nav-item"><span>GPA/CGPA Calculation</span></div>
                <div class="nav-item"><span>Planner</span></div>
            </nav>
        </aside>

        <main class="main-content">
            <div class="folders-container">
                {% if not organized %}
                    <div class="post">
                        <p>You haven't created any folders yet.</p>
                    </div>
                {% endif %}

                {% for folder_name, posts in organized.items() %}
                    <div class="folder-group">
                        <h2 class="folder-header" onclick="toggleFolder(this)">
                            üìÅ {{ folder_name }}
                        </h2>
                        
                        <div class="folder-content">
                            {% for post in posts %}
                            <div class="post-card">
                                <p><strong>{{ post.poster }}</strong></p>
                                <p>{{ post.content }}</p>
                                
                                {% if post.file %}
                                    {% if post.file.lower().endswith(('.png', '.jpg', '.jpeg', '.gif')) %}
                                        <div class="image-container">
                                            <a href="{{ url_for('static', filename='uploads/' ~ post.file) }}" target="_blank">
                                                <img src="{{ url_for('static', filename='uploads/' ~ post.file) }}" 
                                                     alt="Saved image" 
                                                     class="post-image-preview">
                                            </a>
                                        </div>
                                    {% else %}
                                        <div class="file-link">
                                            <a href="{{ url_for('static', filename='uploads/' ~ post.file) }}" target="_blank">
                                                üìÑ Open: {{ post.file }}
                                            </a>
                                        </div>
                                    {% endif %}
                                {% endif %}
                                
                                <div class="post-actions">
                                    <form action="{{ url_for('unsave', sp_id=post.sp_id) }}" method="POST">
                                        <button type="submit" class="remove-btn">Remove</button>
                                    </form>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </main>
    </div>
</div>

<script>
    function toggleFolder(header) {
        const content = header.nextElementSibling;
        content.classList.toggle('active');
    }
</script>
</body>
</html>
